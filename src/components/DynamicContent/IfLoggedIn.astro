---
// This is the frontmatter section where you can import other components or scripts if needed

//DOCS: https://github.com/netlify/netlify-identity-widget/tree/master

import LoadingPlaceholder from '~/components/DynamicContent/LoadingPlaceholder.astro';

const { info } = Astro.props as Props;
---

<div class="IfLoggedIn">

  <div class="placeholder">
    <!-- <LoadingPlaceholder/> -->
  </div>
  
  <div class="loggedIn">
    <slot name="loggedIn"/>
  </div>

  <div class="loggedOut">
    <slot name="loggedOut"/>
  </div>

</div>

<style lang="scss">
  .IfLoggedIn{
    .placeholder{display: block;}
    .loggedIn{display: none;}
    .loggedOut{display: none;}

    &.currentlyLoggedIn{
      .placeholder{display: none;}
      .loggedIn{display: block;}
      .loggedOut{display: none;}
    }
    &.currentlyLoggedOut{
      .placeholder{display: none;}
      .loggedIn{display: none;}
      .loggedOut{display: block;}
    }
  }
</style>

<script>
  function delayedFunction() {
    console.log("IfLoggedIn functions executed.");

    //grab all user info
    var user = netlifyIdentity.currentUser();
    console.log("Netlify User Info: ",user);
    var elements = document.querySelectorAll('.IfLoggedIn');

    if( user === null){
      //logged out
      console.log("Logged Out");
      elements.forEach(element => {
        //target all instances of ModalWrapper
        element.classList.add("currentlyLoggedOut"); 
      });
    }else{
      //logged in
      console.log("Logged In");
      elements.forEach(element => {
        //target all instances of ModalWrapper
        element.classList.add("currentlyLoggedIn"); 
      });
    }

    

  }

  function waitForDelay(seconds, callback) {
    setTimeout(callback, seconds * 1000);
  }

  const delayInSeconds = 5; // Change this to the desired delay in seconds
  waitForDelay(delayInSeconds, delayedFunction);


  


</script>